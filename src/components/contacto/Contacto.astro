---
import { Phone } from "lucide-astro";
---

<div
    class="bg-white w-full min-h-screen flex flex-col items-center px-6 md:px-16 pt-32 pb-12 md:pt-40 md:pb-16 select-none"
    id="contacto"
>
    <h1
        class="relative text-[#05F2AF] font-anton uppercase text-[12vw] sm:text-[9vw] md:text-[7vw] lg:text-[5vw] shine-title whitespace-nowrap italic px-4 text-center mb-8"
    >
        CONTACTO
    </h1>

    <div class="grid md:grid-cols-2 gap-6 md:gap-8 max-w-5xl w-full">
        <!-- Parte Izquierda: Información de WhatsApp -->
        <div class="flex flex-col items-center justify-center space-y-4">
            <div class="space-y-2 text-center">
                <h2 class="text-base font-bold text-[#11071F] uppercase">
                    Información de Contacto
                </h2>
                <p class="text-gray-600 text-sm leading-relaxed">
                    Puedes comunicarte por WhatsApp escaneando el código o
                    haciendo clic en el botón.
                </p>
            </div>

            <div
                class="bg-[#11071F] border-b-4 border-[#05F2AF] p-6 rounded-3xl shadow-xl backdrop-blur
                       text-center w-full max-w-sm flex flex-col items-center gap-4"
            >
                <div class="space-y-3">
                    <h3
                        class="text-xl text-[#05F2AF] uppercase font-anton italic"
                    >
                        WhatsApp
                    </h3>

                    <p
                        class="text-gray-300 text-sm tracking-wide flex items-center justify-center gap-2"
                    >
                        <Phone class="w-4 h-4 text-[#05F2AF]" />
                        +52 449 572 9599
                    </p>

                    <img
                        src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://wa.me/524495729599"
                        alt="QR WhatsApp"
                        class="mx-auto rounded-2xl shadow-lg p-4 hover:scale-[1.05] transition-all cursor-pointer"
                    />

                    <a
                        href="https://wa.me/524495729599"
                        class="italic font-bold text-[#05f2af] border border-[#05f2af]/40 px-8 py-2.5 relative transition-all duration-300
                           hover:text-white hover:border-white rounded-3xl overflow-hidden text-sm
                           before:absolute before:inset-0 before:bg-[#05f2af]/10 before:-skew-x-6
                           before:transition-all before:duration-300 hover:before:bg-white/10 before:rounded-3xl block"
                    >
                        Enviar Mensaje
                    </a>
                </div>
            </div>
        </div>

        <!-- Parte Derecha: Formulario -->
        <div class="flex flex-col items-center justify-center">
            <div
                class="bg-[#11071F] border-b-4 border-[#05F2AF] p-6 rounded-3xl shadow-xl backdrop-blur w-full max-w-md"
            >
                <h3
                    class="text-xl text-[#05F2AF] uppercase text-center mb-4 font-anton italic"
                >
                    Envía un Mensaje
                </h3>

                <form id="contactForm" class="space-y-3">
                    <div>
                        <label
                            for="nombre"
                            class="block text-gray-300 text-xs mb-1.5"
                        >
                            Nombre
                        </label>
                        <input
                            type="text"
                            id="nombre"
                            name="name"
                            required
                            class="w-full px-3 py-2.5 bg-white/10 border border-[#05F2AF]/30 rounded-xl text-white text-sm placeholder-gray-400
                                   focus:outline-none focus:border-[#05F2AF] focus:ring-2 focus:ring-[#05F2AF]/20 transition-all"
                            placeholder="Tu nombre"
                        />
                    </div>

                    <div>
                        <label
                            for="email"
                            class="block text-gray-300 text-xs mb-1.5"
                        >
                            Email
                        </label>
                        <input
                            type="email"
                            id="email"
                            name="email"
                            required
                            class="w-full px-3 py-2.5 bg-white/10 border border-[#05F2AF]/30 rounded-xl text-white text-sm placeholder-gray-400
                                   focus:outline-none focus:border-[#05F2AF] focus:ring-2 focus:ring-[#05F2AF]/20 transition-all"
                            placeholder="tu@email.com"
                        />
                    </div>

                    <div>
                        <label
                            for="mensaje"
                            class="block text-gray-300 text-xs mb-1.5"
                        >
                            Mensaje
                        </label>
                        <textarea
                            id="mensaje"
                            name="mensaje"
                            rows="3"
                            required
                            class="w-full px-3 py-2.5 bg-white/10 border border-[#05F2AF]/30 rounded-xl text-white text-sm placeholder-gray-400
                                   focus:outline-none focus:border-[#05F2AF] focus:ring-2 focus:ring-[#05F2AF]/20 transition-all resize-none"
                            placeholder="Cuéntame en que puedo ayudarte."
                        ></textarea>
                    </div>

                    <button
                        id="submitBtn"
                        type="submit"
                        class="cursor-pointer w-full italic font-bold text-[#05f2af] border border-[#05f2af]/40 px-8 py-2.5 relative transition-all duration-300
                               hover:text-white hover:border-white rounded-3xl overflow-hidden text-sm
                               before:absolute before:inset-0 before:bg-[#05f2af]/10 before:-skew-x-6
                               before:transition-all before:duration-300 hover:before:bg-white/10 before:rounded-3xl"
                    >
                        Enviar Mensaje
                    </button>

                    <p
                        id="formMessage"
                        class="text-center text-xs mt-2 text-white"
                    >
                    </p>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    const form = document.getElementById("contactForm") as HTMLFormElement;
    const msg = document.getElementById("formMessage") as HTMLParagraphElement;
    const btn = document.getElementById("submitBtn") as HTMLButtonElement;

    form.addEventListener("submit", async (e) => {
        e.preventDefault();

        btn.disabled = true;
        btn.textContent = "Enviando...";
        btn.classList.add("opacity-60");
        msg.textContent = "";

        const formData = new FormData(form);

        const response = await fetch("/api/contact", {
            method: "POST",
            body: formData,
        });

        const result = await response.json();

        if (response.ok) {
            msg.textContent = "✔ Tu mensaje ha sido enviado con éxito.";
            msg.className = "text-center text-xs mt-2 text-[#05F2AF]";
            form.reset();
        } else {
            msg.textContent = "❌ Ocurrió un error, intenta más tarde.";
            msg.className = "text-center text-xs mt-2 text-red-500";
        }

        btn.disabled = false;
        btn.textContent = "Enviar Mensaje";
        btn.classList.remove("opacity-60");
    });
</script>
